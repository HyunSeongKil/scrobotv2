<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="popPrjSelect">
	
	<select id="retrievePrjList" parameterType="hashmap" resultType ="HashMap">

	    	/* popPrjSelect.retrievePrjList */
	    	
			SELECT PR.PRJ_ID
				 , PR.PRJ_NM
			     , DATE_FORMAT(PR.MAKE_DTTM,'%Y-%m-%d %H:%i:%s') AS MAKE_DTTM
			FROM PRJCT PR
			INNER JOIN USER US
			ON PR.CRTR_ID = US.USER_ID
			LEFT OUTER JOIN DEPT DP
			ON US.DEPT_NO = DP.DEPT_NO
			WHERE PR.CRTR_ID IN (SELECT USER_ID
			                       FROM USER
			                       WHERE DEPT_NO = (SELECT DEPT_NO
			                                        FROM USER
			                                        WHERE USER_ID = #{USER_ID})
			                       )
			<if test='PRJ_NM != "" and PRJ_NM != null'>
			AND UPPER(PRJ_NM) LIKE UPPER(CONCAT('%', #{PRJ_NM}, '%'))
			</if>
			ORDER BY PR.MAKE_DTTM DESC
	</select>
	
</mapper>